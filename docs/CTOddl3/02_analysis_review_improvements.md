# CTOddl3 분석 문서 재검토 및 개선점

## 1. 재검토 대상

- `docs/CTOddl3/01_source_analysis.md`

## 2. 재검토 결과 (분석 문서의 부족한 점)

`01_source_analysis.md`는 원본의 큰 문제를 빠르게 파악하는 데는 충분하지만, 실제 DDL 개선 작업에 바로 투입하기에는 아래 정보가 부족했습니다.

| 구분 | 부족한 점 | 보완 필요 이유 |
|---|---|---|
| 추적성 | 원본 DDL 라인 번호 기준 근거가 없음 | 검토/리뷰 시 사실 확인 시간이 늘어남 |
| 컬럼 수준 분석 | 테이블별 컬럼/타입/NULL/기본값 비교표가 없음 | 마이그레이션 설계 시 누락 위험 |
| 정책 구분 | “필수 규칙”과 “권장 규칙”이 혼재 | 구현 우선순위 혼동 가능 |
| 적용 전략 | 기존 운영 DB 이관 시나리오(ALTER vs 재생성) 미포함 | 실행 계획 수립 어려움 |
| 검증 계획 | 샘플 쿼리/테스트 체크리스트 부재 | DDL 반영 후 검증 기준 불명확 |

## 3. 추가로 보완하면 좋은 분석 항목

### 3.1 컬럼 표준화 규칙 문서화

아래 항목은 별도 문서(추가 작성 권장)로 분리하면 좋습니다.

- 코드값 컬럼 접미사 통일: `*_code`
- 불리언 기본값 통일: `FALSE`
- 감사 컬럼 규칙 통일: `created_at`, `updated_at`, `deleted_at`
- 소프트삭제 규칙 통일: `is_deleted` + `deleted_at`

### 3.2 관계 설계 기준 명시

분석 문서에는 문제 지적은 있으나, “앞으로 어떤 기준으로 관계를 설계할지”가 더 명확하면 좋습니다.

- 식별자 PK는 단일 컬럼 `id`
- 업무 중복 방지는 `UNIQUE KEY`
- 매핑 테이블은 중복 관계를 제거하고 FK만 유지
- 이벤트 결과 테이블(`event_win`)은 근거 테이블 FK를 모두 가짐

### 3.3 테이블 분리 기준 정리

원본에는 `event_entry`, `event_applicant`, `event_win`이 모두 존재합니다. 역할 경계가 문서에 일부 설명되어 있으나, 운영 구현 관점에서는 아래 기준이 더 분명해야 합니다.

- `event_applicant`: 참여 가능/중복방지 기준
- `event_entry`: 실제 응모 이력(로그)
- `event_win`: 당첨 결과 및 후속 처리 상태

## 4. DDL 개선안 문서(03) 작성 시 반영한 사항

이번 `03_simplified_ddl_with_sample_data.md`에는 `01`의 부족한 점을 보완하기 위해 아래를 반영합니다.

1. 원본 문제를 직접 해결한 간소화 DDL 제시
2. 예시 데이터 INSERT 포함
3. 원본과 다른 점(간소화 포인트) 명시
4. 복잡한 복합 PK 대신 단일 PK + UNIQUE 방식 적용

## 5. 추가 개선 문서 제안 (선택)

필요하면 아래 문서를 `CTOddl3`에 추가하면 운영/개발 협업에 더 유용합니다.

| 파일명(예시) | 목적 |
|---|---|
| `04_column_mapping_from_source.md` | 원본 컬럼명 ↔ 개선안 컬럼명 매핑 |
| `05_migration_checklist.md` | 데이터 이관/검증 체크리스트 |
| `06_query_examples.md` | 조회/추첨/당첨 처리 예시 쿼리 |

## 6. 결론

`01`은 “진단 문서”로는 충분하고, 실제 적용 단계에서는 컬럼 단위 기준/검증 계획이 추가되어야 합니다.  
이번 요청 범위에서는 `03`의 간소화 DDL + 예시 데이터 문서가 바로 활용 가능한 결과물 역할을 합니다.

